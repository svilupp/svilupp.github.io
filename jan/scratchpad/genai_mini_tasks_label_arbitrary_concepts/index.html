<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/styles/github.min.css"> <!-- bootstrap@5.3.1 and bootstrap icon@1.10--> <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel=stylesheet  integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin=anonymous > <link rel=stylesheet  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"> <link rel=stylesheet  href="/css/style.css"> <link rel=stylesheet  href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"> <link data-n-head=ssr  rel=stylesheet  href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons"> <link rel=stylesheet  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin=anonymous  referrerpolicy=no-referrer  /> <link rel=stylesheet  href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin=anonymous  referrerpolicy=no-referrer  /> <!-- favicon generated through https://realfavicongenerator.net/--> <link rel=apple-touch-icon  sizes=180x180  href="/assets/icon/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="/assets/icon/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="/assets/icon/favicon-16x16.png"> <link rel=manifest  href="/assets/icon/site.webmanifest"> <link rel=mask-icon  href="/assets/icon/safari-pinned-tab.svg" color="#5bbad5"> <meta name=msapplication-TileColor  content="#da532c"> <meta name=theme-color  content="#ffffff"> <link rel=stylesheet  href="/_css/custom.css"> <title>Concepts to Spectrums: Unleashing LLM's Power in Text Analysis</title> <header class=bootstrap-styles  data-bs-theme=dark > <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"> <div class=container > <a href="/" class="navbar-brand d-flex align-items-center"> <svg xmlns="http://www.w3.org/2000/svg" width=16  height=16  fill=currentColor  class="bi bi-journal-text me-2" viewBox="0 0 16 16"> <path d="M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/> <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/> <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/> </svg> <strong>siml.earth</strong> </a> <button class=navbar-toggler  type=button  data-bs-toggle=collapse  data-bs-target="#navbarCollapse" aria-controls=navbarCollapse  aria-expanded=false  aria-label="Toggle navigation"> <span class=navbar-toggler-icon ></span> </button> <div class="collapse navbar-collapse" id=navbarCollapse > <ul class="navbar-nav me-auto mb-2 mb-md-0"> <li class="nav-item dropdown"> <a class="nav-link dropdown-toggle fw-bold" href="#" id=navbarDropdown  role=button  data-bs-toggle=dropdown  aria-expanded=false > Sites </a> <ul class=dropdown-menu  aria-labelledby=navbarDropdown > <li><h6 class=dropdown-header >Choose a Site</h6> <li><a class=dropdown-item  href="/jan/">Jan's Site</a> <li><a class=dropdown-item  href="/ann/">Ann's Site</a> </ul> <li class=nav-item ><hr class="dropdown-divider mx-2"> <li class=nav-item > <span class="navbar-text px-2 fw-bold d-flex align-items-center">Jan's:</span> <li class=nav-item > <a class=nav-link  aria-current=page  href="/jan/">Home</a> <li class=nav-item > <a class=nav-link  href="/jan/scratchpad/">Posts</a> <li class=nav-item > <a class=nav-link  href="/jan/wip/">Work in Progress</a> <li class=nav-item > <a class=nav-link  href="/jan/about/">About</a> <li class=nav-item > <a class=nav-link  href="/jan/tags/">Tags</a> <li class=nav-item > <a class=nav-link  href="/jan/privacy_policy/">Privacy Policy</a> <li class=nav-item > <a class=nav-link  href="/jan/cookie_policy/">Cookie Policy</a> </ul> </div> </div> </nav> </header> <div class="container py-3 px-3 mx-auto"> <div class=franklin-content ><h1 id=tldr ><a href="#tldr" class=header-anchor >TL;DR</a></h1> <p>Explore the new capabilities of LLMTextAnalysis.jl to explore any arbitrary concept and spectrum. We demonstrate how to easily evaluate responses on whether they are &quot;action-oriented&quot; and &quot;forward-looking&quot;.</p> <p><div class=franklin-toc ><ol><li><a href="#tldr">TL;DR</a><ol><li><a href="#introduction">Introduction</a><li><a href="#getting_started">Getting Started</a><li><a href="#preparing_the_data">Preparing the Data</a><li><a href="#building_the_text_index">Building the Text Index</a><li><a href="#understanding_concept_and_spectrum">Understanding Concept and Spectrum</a><li><a href="#training_a_concept">Training a Concept</a><li><a href="#training_a_spectrum">Training a Spectrum</a><li><a href="#visualization_and_interactive_analysis">Visualization and Interactive Analysis</a><li><a href="#conclusion">Conclusion</a></ol></ol></div> </p> <h2 id=introduction ><a href="#introduction" class=header-anchor >Introduction</a></h2> <p>In the world of data science, Large Language Models &#40;LLMs&#41; offer an innovative approach to text analysis. This blog post demonstrates an application of LLMTextAnalysis.jl on the City of Austin&#39;s Community Survey, focusing on classifying responses by their alignment with specific concepts and spectrums.</p> <p>We will pick one open-ended question. Let&#39;s say we want to help the mayor to prioritize ideas, so we will lay out the verbatims against the concepts of being &quot;action-oriented&quot; and &quot;forward-looking&quot;.</p> <h2 id=getting_started ><a href="#getting_started" class=header-anchor >Getting Started</a></h2> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Downloads, CSV, DataFrames
<span class=hljs-keyword >using</span> Plots
<span class=hljs-keyword >using</span> LLMTextAnalysis
plotlyjs(); <span class=hljs-comment ># for interactive plots</span></code></pre> <h2 id=preparing_the_data ><a href="#preparing_the_data" class=header-anchor >Preparing the Data</a></h2> <p>Download the survey data</p> <pre><code class="julia hljs">Downloads.download(<span class=hljs-string >&quot;https://data.austintexas.gov/api/views/s2py-ceb7/rows.csv?accessType=DOWNLOAD&quot;</span>,
    joinpath(<span class=hljs-meta >@__DIR__</span>, <span class=hljs-string >&quot;cityofaustin.csv&quot;</span>));</code></pre> <p>Read the survey data into a DataFrame</p> <pre><code class="julia hljs">df = CSV.read(joinpath(<span class=hljs-meta >@__DIR__</span>, <span class=hljs-string >&quot;cityofaustin.csv&quot;</span>), DataFrame);</code></pre>
<p>Let&#39;s select one of the open-ended questions, eg,</p>
<pre><code class="julia hljs">col = <span class=hljs-string >&quot;Q25 - If there was one thing you could share with the Mayor regarding the City of Austin (any comment, suggestion, etc.), what would it be?&quot;</span>
docs = df[!, col] |&gt; skipmissing |&gt; collect;</code></pre>
<h2 id=building_the_text_index ><a href="#building_the_text_index" class=header-anchor >Building the Text Index</a></h2>
<p>Indexing documents, or survey responses in our case, is the first critical step. The <code>build_index</code> function prepares the data for subsequent analysis.</p>
<pre><code class="julia hljs">index = build_index(docs)
<span class=hljs-comment ># Output: DocIndex(Documents: 2933, PlotData: None, Topic Levels: None)</span></code></pre>
<p>Let&#39;s use those 30 seconds to understand the difference between a concept and a spectrum.</p>
<h2 id=understanding_concept_and_spectrum ><a href="#understanding_concept_and_spectrum" class=header-anchor >Understanding Concept and Spectrum</a></h2>
<p>Sometimes you know what you&#39;re looking for, but it&#39;s hard to define the exact keywords. For example, you might want to identify documents that are &quot;action-oriented&quot; or &quot;pessimistic&quot; or &quot;forward-looking&quot;.</p>
<p>For these situations, <code>LLMTextAnalysis</code> offers two basic functionalities: <code>train_concept</code> and <code>train_spectrum</code>. Each serves a different purpose in text analysis.</p>
<ul>
<li><p><strong>Concept &#40;type: <code>TrainedConcept</code>&#41;</strong>:</p>
<ul>
<li><p><strong>Purpose</strong>: Analyzes a single, specific idea within texts.</p>

<li><p><strong>Ideal Use</strong>: Best for targeted analysis focusing on a singular concept.</p>

<li><p><strong>Function</strong>: <code>train_concept</code></p>

</ul>

<li><p><strong>Spectrum &#40;type: <code>TrainedSpectrum</code>&#41;</strong>:</p>
<ul>
<li><p><strong>Purpose</strong>: Places texts on a continuum between two opposing concepts.</p>

<li><p><strong>Ideal Use</strong>: Suitable for comparative analysis between contrasting ideas.</p>

<li><p><strong>Function</strong>: <code>train_spectrum</code></p>

</ul>

</ul>
<p>Why do we need <code>train_spectrum</code> and not simply use two <code>TrainedConcepts</code>? It&#39;s because the opposite of &quot;forward-looking&quot; can be many things, eg, &quot;short-sighted&quot;, &quot;dwelling in the past&quot;, or simply &quot;not-forward looking&quot;.</p>
<h2 id=training_a_concept ><a href="#training_a_concept" class=header-anchor >Training a Concept</a></h2>
<p>Let&#39;s say we want to identify documents that are &quot;action-oriented&quot;. We can use <code>train_concept</code> to train a model to identify documents that are &quot;action-oriented&quot; and score the documents against the concept.</p>
<p>Let&#39;s show the top 5 documents that are most &quot;action-oriented&quot;.</p>
<pre><code class="julia hljs">concept = train_concept(index,
    <span class=hljs-string >&quot;action-oriented&quot;</span>;
    aigenerate_kwargs = (; model = <span class=hljs-string >&quot;gpt3t&quot;</span>))

scores = score(index, concept)
index.docs[first(sortperm(scores, rev = <span class=hljs-literal >true</span>), <span class=hljs-number >5</span>)]</code></pre>
<pre><code class="plaintext hljs">5-element Vector{String}:
 &quot;stop delaying important decisions and make the best one available and move on to solutions&quot;
 &quot;We need real transportation options, not just more lip service and endless studies that do not achieve implementation.&quot;
 &quot;We need a comprehensive plan/vision for managing the growth of this city!&quot;
 &quot;Ensure that all citizens, regardless of race/ethnicity, gender, gender identity feel protected and respected by our police services.&quot;
 &quot;we need to plan for global climate change, water and energy programs must be robust&quot;</code></pre>
<h2 id=training_a_spectrum ><a href="#training_a_spectrum" class=header-anchor >Training a Spectrum</a></h2>
<p>We may want to define an arbitrary &quot;spectrum&quot; &#40;axis/polar opposites&#41; and score documents on it. Let&#39;s introduce a spectrum for &quot;dwelling in the past&quot; vs &quot;forward-looking&quot;. The higher the score &#40;eg, 100&#37;&#41;, the more &quot;forward-looking&quot; the document/text is.</p>
<p>Let&#39;s show the top 5 documents that are most &quot;forward-looking&quot;.</p>
<pre><code class="julia hljs">spectrum = train_spectrum(index,
    (<span class=hljs-string >&quot;dwelling in the past&quot;</span>, <span class=hljs-string >&quot;forward-looking&quot;</span>);
    aigenerate_kwargs = (; model = <span class=hljs-string >&quot;gpt3t&quot;</span>))

scores = score(index, spectrum)
index.docs[first(sortperm(scores, rev = <span class=hljs-literal >true</span>), <span class=hljs-number >5</span>)]</code></pre>
<pre><code class="plaintext hljs">5-element Vector{String}:
 &quot;Enhance affordability and ensure a diverse, healthy population.&quot;
 &quot;MANAGING GROWTH IN A WAY THAT IMPROVES QUALITY OF LIFE FOR ALL CITIZENS&quot;
 &quot;Affordable housing. Better planning for future. Mass transit (rail system that covers City wide.&quot;
 &quot;Plan for greater urban density and more public transportation.&quot;
 &quot;need more affordable housing and more public transportation to ensure diverse and successful population&quot;</code></pre>
<p>And how about the ones &quot;dwelling in the past&quot; &#40;set <code>rev&#61;false</code> to look for low scores&#41;?</p>
<pre><code class="julia hljs">index.docs[first(sortperm(scores, rev = <span class=hljs-literal >false</span>), <span class=hljs-number >5</span>)]</code></pre>
<pre><code class="plaintext hljs">5-element Vector{String}:
 &quot;It is so sad to see long time local business disappearing. We loved Austin because it was unique, and used to have the feeling of a small town with the advantages of a big city. Now, it is just another city in Texas with gas stations,  banks and Walgreen&#x27;s on every corner of every rd. So sad to see Austin go down that rd!&quot;
 &quot;The cost of living in Austin and the surrounding v areas is 100% absurd. Beyond ridiculous. I would do anything to have the \&quot;old Austin\&quot; back.&quot;
 &quot;Used to be proud of Austin and tour visiting friends around.\nNow it&#x27;s just a crowded nasty city.&quot;
 &quot;I WISH I HAD BUS STOP BACK AT LEDESMA AND LOTT. I USED TO RIDE THE BUS TO WORK.&quot;
 &quot;I&#x27;m really sad about what Austin has become.  It used to feel like home.  Now, it just feels like a big, impersonal city with not much personality, and a lot of traffic (and high taxes).  The city that I loved is gone, which makes me sad and angry.&quot;</code></pre>
<h2 id=visualization_and_interactive_analysis ><a href="#visualization_and_interactive_analysis" class=header-anchor >Visualization and Interactive Analysis</a></h2>
<p>Visualizing the results is made easy with <code>plot</code> and can be enhanced with <code>PlotlyJS</code> for interactivity.</p>
<p>The positions of arguments <code>concept</code> and <code>spectrum</code> are important, as they determine the position of the concepts in the plot &#40;x-axis, y-axis&#41;</p>
<pre><code class="julia hljs">pl = plot(index, spectrum, concept;
    title = <span class=hljs-string >&quot;Prioritizing Action-Oriented and Forward-Looking Ideas (Top-right Corner)&quot;</span>)</code></pre>
<p><img src="/assets/genai_mini_tasks_label_arbitrary_concepts/scatter-plot.png" alt="Prioritized Ideas" /></p>
<p>Note: What if you need to add some additional information to the tooltip for each data point? You can do that with <code>hoverdata</code> argument, see <code>?plot</code> for more details.</p>
<h2 id=conclusion ><a href="#conclusion" class=header-anchor >Conclusion</a></h2>
<p>Concept labeling provides a nuanced approach to text analysis, suitable for a wide range of applications in data science. It empowers users to go beyond traditional analysis methods, offering insights into previously unexplored areas of textual data.</p>
<div class=page-foot >
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Jan Siml. Last modified: November 27, 2024.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
</div></div> 

<footer class=container >
  <p class=float-end ><a href="#">Back to top</a></p>
  <div class=footer-icons >
      <ul class=social-icons >
          <li><strong>Follow:</strong>
          <li><a href="https://github.com/svilupp" rel="nofollow noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width=16  height=16  fill=currentColor  class="bi bi-github" viewBox="0 0 16 16">
              <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
            </svg> GitHub</a>
      </ul>
  </div>
  <p class=copyright >&copy; 2023- Company, Inc. · <a href="#">Privacy</a> · <a href="#">Terms</a></p>
</footer>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity=sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm  crossorigin=anonymous ></script>


  <script src="/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>


<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>