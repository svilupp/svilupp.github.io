<!doctype html> <html lang=en > <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-M28VNQP');</script> <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link href="/css/franklin.css" rel=stylesheet > <link href="/css/vela.css" rel=stylesheet > <script src="/libs/vela/jquery.min.js"></script> <link rel=icon  href="/assets/favicon.png"> <title>Jan's Scratchpad</title> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M28VNQP" height=0  width=0  style="display:none;visibility:hidden"></iframe></noscript> <div class="main-nav slideout-menu slideout-menu-left" id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>Scratchpad</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/index.html">Home</a> <li><a href="/scratchpad/">Posts</a> <li><a href="/about/">About</a> <li><a href="/tag/">Tags</a> <li><a href="/privacy_policy/">Privacy Policy</a> <li><a href="/cookie_policy/">Cookie Policy</a> </ul> </nav> </div> <main id=panel  class="slidout-panel slideout-panel-left"> <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">Set up Privacy-conscious Analytics in 20 Minutes</h1> <hr> <div class=franklin-content ><h1 id=this_is_an_unfinished_draft ><a href="#this_is_an_unfinished_draft" class=header-anchor >THIS IS AN UNFINISHED DRAFT</a></h1> <h1 id=tldr ><a href="#tldr" class=header-anchor >TL;DR</a></h1> <p>Privacy policy is legally required for majority of websites. If you want an effortless option, consider Plausible.io for 90 eur/month. Best free option I found is Termly &#43; Google Tag Manager &#43; Google Analytics.</p> <h1 id=motivation ><a href="#motivation" class=header-anchor >Motivation</a></h1> <p>As an improvement-obsessed person, when I set up my personal blog &#40;<a href="https://simlj.earth">here</a>, effortless thanks to <a href="https://franklinjl.org/">Franklin.jl</a>&#41; my first thought was “how will I measure the traffic to keep getting better?&quot;</p> <p>While Google analytics is an easy choice for tracking, it is no longer sufficient on its own. It is legally required in many countries to have a privacy policy AND to obtain user’s consent before you start tracking &#40;in most cases&#41;.</p> <p>This blog post is a summary of my research and a brief how to guide to help you set up privacy-conscious &#40;and compliant&#41; website analytics for free in 20 minutes.</p> <h1 id=does_it_concern_my_website ><a href="#does_it_concern_my_website" class=header-anchor >Does it concern my website?</a></h1> <p>Oversimplifying here a bit but if you use any of cookies, IP addresses &#40;location&#41;, browser or device information or any standard analytics solution &#40;Google analytics, Matomo, etc&#41; you need to read on.</p> <p>The reason is that if an EU citizen visits your website, you are liable to EU&#39;s <a href="https://gdpr.eu/what-is-gdpr/">General Data Protection Regulation &#40;GDPR&#41;</a>. That means you need to follow specific rules for:</p> <ul> <li><p>what information you need to provide</p> <li><p>what form and type of consent you require</p> <li><p>what you can and cannot track &#40;eg, IP address is considered to be a Personal Identifiable Information &#40;PII&#41;&#41;</p> <li><p>how you need to process, transfer the information</p> <li><p>and much more...</p> </ul> <p>The similar holds for other privacy regulations around the world &#40;eg, <a href="https://ico.org.uk/for-organisations/guide-to-data-protection/guide-to-the-general-data-protection-regulation-gdpr/">UK&#39;s GDPR</a>, <a href="https://www.priv.gc.ca/en/privacy-topics/privacy-laws-in-canada/the-personal-information-protection-and-electronic-documents-act-pipeda/pipeda_brief/">Canadian PIPEDA</a>, <a href="https://www.csoonline.com/article/3292578/california-consumer-privacy-act-what-you-need-to-know-to-be-compliant.html">Californian CCPA</a>&#41;</p> <p>Practically, you should also publish Terms and Conditions for your website &#40;even if it&#39;s a persoanl website&#41;, but that&#39;s a separate topic&#33;</p> <p>Now that we have established the need, let’s look into what we need to do.</p> <h1 id=so_what_do_i_need_to_do ><a href="#so_what_do_i_need_to_do" class=header-anchor >So what do I need to do?</a></h1> <p>You can read about it in detail <a href="https://www.termsfeed.com/blog/sample-blog-privacy-policy-template/">here</a> or from a more authoritative source <a href="https://ico.org.uk/for-organisations/guide-to-data-protection/guide-to-the-general-data-protection-regulation-gdpr/the-right-to-be-informed/what-privacy-information-should-we-provide/">here</a>.</p> <p>In short, we need to:</p> <ul> <li><p>collect, transfer and store the minimum information possible &#40;in most cases your personal blog requires little or no Personal Identifiable Information &#40;PII&#41;&#41; in a safe and compliant way &#40;best to leave it to specialists&#41;</p> <li><p>request user&#39;s consent before any tracking starts &#40;eg, before any cookies or PII is collected&#41; and ensure it&#39;s an explicit opt-in &#40;ie, an implicit consent if the user ignores the pop up is not sufficient&#33;&#41;</p> <li><p>create a Privacy and Cookie Policy for your website that describe what you track, how and why</p> </ul> <h1 id=solution_comparison ><a href="#solution_comparison" class=header-anchor >Solution Comparison</a></h1> <p>TODO: Add more detail for each</p> <h3 id=gold_solution_plausibleio ><a href="#gold_solution_plausibleio" class=header-anchor >Gold Solution: Plausible.io</a></h3> <h3 id=silver_solution_google_termly_my_choice ><a href="#silver_solution_google_termly_my_choice" class=header-anchor >Silver Solution: Google &#43; Termly &lt;– My Choice</a></h3> <h3 id=bronze_solution_google_osano_termsfeed ><a href="#bronze_solution_google_osano_termsfeed" class=header-anchor >Bronze Solution: Google &#43; Osano &#43; Termsfeed</a></h3> <h1 id=deep_dive_on_the_winning_solution ><a href="#deep_dive_on_the_winning_solution" class=header-anchor >Deep dive on the winning solution</a></h1> <p>The winning solution for me was #2. It requires slightly more effort to set up, but it’s free &#40;great for personal or open source projects&#33;&#41; and has more powerful analytics features for the future.</p> <ul> <li><p>Tracking: GoogleAnalytics version GA4</p> </ul> <blockquote> <p>Side note: Why GA4 and not Universal Analytics &#40;UA&#41;?</p> <p>No one should start a new analytics account with UA in 2022, as it will be sunset in July 2023. Moreover, GA4 has been built with modern considerations and experiences in mind &#40;eg, mobile devices, privacy-conscious consumers&#41;. This tutorial does not take advantage of its full power but it gives you extensible option for the future &#40;eg, estimated traffic if everyone consented to tracking&#41;</p> </blockquote> <ul> <li><p>Consent Management: Termly.io</p> <li><p>Privacy Policy and Cookie Policy generation: Termly.io</p> <li><p>Orchestration: Google Tag Manager</p> </ul> <h1 id=setting_up_our_solution ><a href="#setting_up_our_solution" class=header-anchor >Setting up our solution</a></h1> <p>TODO: Add screenshots and more detail</p> <h3 id=set_up_ga4 ><a href="#set_up_ga4" class=header-anchor ><ol> <li><p>Set up GA4</p> </ol> </a></h3> <ul> <li><p>Create an account <a href="https://analytics.google.com/">here</a></p> <li><p>Set up a Property for measurements &#40;Bottom left - Admin - Create Account - Create Property&#41;</p> <li><p>TODO: finish with a screenshot</p> <li><p>Click on xyz to get to measurement ID &lt;- Save this for later, we will need it to set up the Google Tag Manager</p> </ul> <p>I’d highly recommended changing some of the default settings to capture only what is strictly necessary and retain data &#40;and cookies&#41; for as short time as possible. The letter of law might have many interpretations here but your visitors will certainly appreciate it&#33;</p> <h3 id=ol_start2_set_up_termly_10_mins ><a href="#ol_start2_set_up_termly_10_mins" class=header-anchor ><ol start=2 > <li><p>Set up Termly &#91;10 mins&#93;</p> </ol> </a></h3> <ul> <li><p>Sign up for a Basic plan <a href="https://app.termly.io/user/sign-up">here</a></p> <li><p>Enter some basic details for your website &#40;enter the name, address, etc&#41;</p> <ul> <li><p>You should see your dashboard now&#33;</p> </ul> <li><p>Scan your cookies &#40;which will also create your Cookie Policy&#41;</p> <li><p>Generate Privacy Policy by going through the guide &#40;important: provide accurate information&#33;&#41;</p> <li><p>Download the Google Tag Manager configuration .json file from <a href="https://app.termly.io/Termly_GDPR_GTM_Solution.json">here</a> &#40;source: <a href="https://help.termly.io/support/solutions/articles/69000108888-blocking-javascript-third-party-cookies-with-google-tag-manager">Termly support article</a> &#41;</p> <li><p>Save Privacy and Cookie policies into separate HTML files</p> <ul> <li><p>On the dashboard, click on Embed</p> <li><p>Select the HTML options</p> <li><p>Copy the HTML code</p> <li><p>Open a text editor, paste it in and save as privacy<em>policy.html and cookie</em>policy.html, respectively</p> </ul> </ul> <h3 id=ol_start3_set_up_google_tag_manager_gtm ><a href="#ol_start3_set_up_google_tag_manager_gtm" class=header-anchor ><ol start=3 > <li><p>Set up Google Tag Manager &#40;GTM&#41;</p> </ol> </a></h3> <ul> <li><p>Create a Google Tag Manager account for your website with your Google account if you do not have one &#40;<a href="https://tagmanager.google.com">link</a>&#41; - let&#39;s call it &quot;MyWebsite&quot;</p> <li><p>In your default workspace, Go to Admin - Import Container and select the .json file we downloaded from Termly in the previous step</p> <li><p>Choose to merge with your existing setting</p> <li><p>Confirm it - You should see several new &quot;tags&quot; and &quot;triggers&quot; created</p> <li><p>Let&#39;s set up Termly consent banner</p> <ul> <li><p>You should see Tag named &quot;Initialization&quot;, open it</p> <li><p>Copy &amp; paste the code from Termly TODO: add snippet</p> <li><p>Replace the Web ID Code</p> <li><p>TO DO: add screenshot</p> <li><p>Set priority to 10 &#40;to make sure it has priority&#41;</p> </ul> <li><p>Configure up Google Analytics GA4</p> <ul> <li><p>Click New - GA4 configuration</p> <li><p>Select the events you want to track</p> <li><p>Make sure to select trigger &quot;Unblock Analytics Cookies&quot; to ensure GA4 will start only once the user has consented to its</p> </ul> <li><p>Submit the new GTM configuration &#40;top right corner&#41;&#33; Without submitting the new version, it won&#39;t be deployed and it won&#39;t take effect.</p> </ul> <p>A more detailed guide can be found <a href="https://help.termly.io/support/solutions/articles/69000108888-blocking-javascript-third-party-cookies-with-google-tag-manager">here</a></p> <h3 id=ol_start4_update_your_website ><a href="#ol_start4_update_your_website" class=header-anchor ><ol start=4 > <li><p>Update your website</p> </ol> </a></h3> <ul> <li><p>Put your tag manager code in the header of each page &#40;right after &lt;head&gt; tag&#41;</p> <li><p>Upload the respective html files to your website</p> <li><p>Ideally, add links to your privacy policy in the footer on each page</p> </ul> <p>If you use Franklin.jl to produce your website, you can find some additional tips in Appendix.</p> <h3 id=ol_start5_test_that_it_worked ><a href="#ol_start5_test_that_it_worked" class=header-anchor ><ol start=5 > <li><p>Test that it worked</p> </ol> </a></h3> <ul> <li><p>go to your website, a banner should appear</p> <li><p>Open the Inspector &#40;Chrome …&#41; and go to tab Application</p> <li><p>You should not see any ga cookies</p> <li><p>Click on Allow in the Consent Banner and you should see 2 GA cookies &#40;name &quot;_ga*&quot;&#41; appear</p> </ul> <h1 id=appendix ><a href="#appendix" class=header-anchor >Appendix</a></h1> <h2 id=tips_for_integrating_into_franklinjl_websites ><a href="#tips_for_integrating_into_franklinjl_websites" class=header-anchor >Tips for integrating into Franklin.jl websites</a></h2> <ul> <li><p>update the pages to have headers and footers, update navbar, where to put the google tag manager</p> </ul> <h2 id=how_to_reduce_google_cookie_expiration ><a href="#how_to_reduce_google_cookie_expiration" class=header-anchor >How to reduce Google cookie expiration</a></h2> <p>To see the Google support article go <a href="https://support.google.com/analytics/answer/11397207?hl&#61;en">here</a>. The step that was hard for me was that you need to expand the options via &quot;Show All&quot; to see &quot;Override Cookie Settings&quot;</p> <ul> <li><p>Go to your Google Tag Manager account</p> <li><p>Open your Admin console &#40;&quot;Admin&quot; on the bottom left&#41; and select the Property for your website</p> <li><p>Open Data Settings - Data Streams and select your strema &#40;your website&#41;</p> <li><p>Click on Configure Tag Settings &#40;at the bottom&#41;</p> <li><p>And Expand all settings options via &quot;Show All&quot; on the right-hand side</p> <li><p>Select Override Cookie Settings - Edit - Set Cookie expiration to 1 month</p> <li><p>Click &quot;Save&quot; for changes to take effect</p> </ul> <p>&#91;<img src="asserts/how_to_analytics_done_right/ga_change_cookie_expiration.png" alt="Changing GA cookie expiration" />&#93;</p> <h2 id=how_to_reduce_googles_data_retention ><a href="#how_to_reduce_googles_data_retention" class=header-anchor >How to reduce Google&#39;s data retention</a></h2> <ul> <li><p>Go to your Google Analytics account</p> <li><p>Open your Admin console &#40;&quot;Admin&quot; on the bottom left&#41; and select the Property for your website</p> <li><p>Open Data Settings - Data retention</p> <li><p>Change &quot;Event Data Retention&quot; to 2 months</p> <li><p>Click &quot;Save&quot; for changes to take effect</p> </ul> <p>&#91;<img src="asserts/how_to_analytics_done_right/ga_change_data_retention.png" alt="Changing GA data retention" />&#93;</p> <div class=page-foot > <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Jan Siml. Last modified: December 31, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. See the <a href="/privacy_policy/">Privacy Policy</a> </div> </div> </main> <script src="/libs/vela/metisMenu.min.js"></script> <script src="/libs/vela/slideout.min.js"></script>