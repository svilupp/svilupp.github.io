<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/styles/github.min.css"> <!-- bootstrap@5.3.1 and bootstrap icon@1.10--> <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel=stylesheet  integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin=anonymous > <link rel=stylesheet  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"> <link rel=stylesheet  href="/css/style.css"> <link rel=stylesheet  href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"> <link data-n-head=ssr  rel=stylesheet  href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons"> <link rel=stylesheet  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin=anonymous  referrerpolicy=no-referrer  /> <link rel=stylesheet  href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin=anonymous  referrerpolicy=no-referrer  /> <!-- favicon generated through https://realfavicongenerator.net/--> <link rel=apple-touch-icon  sizes=180x180  href="/assets/icon/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="/assets/icon/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="/assets/icon/favicon-16x16.png"> <link rel=manifest  href="/assets/icon/site.webmanifest"> <link rel=mask-icon  href="/assets/icon/safari-pinned-tab.svg" color="#5bbad5"> <meta name=msapplication-TileColor  content="#da532c"> <meta name=theme-color  content="#ffffff"> <link rel=stylesheet  href="/_css/custom.css"> <title>Stop Waiting for Test Data: Accelerate Your Experiments with LLM-Generated Datasets</title> <header class=bootstrap-styles  data-bs-theme=dark > <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"> <div class=container > <a href="/" class="navbar-brand d-flex align-items-center"> <svg xmlns="http://www.w3.org/2000/svg" width=16  height=16  fill=currentColor  class="bi bi-journal-text me-2" viewBox="0 0 16 16"> <path d="M5 10.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0-2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"/> <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/> <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/> </svg> <strong>siml.earth</strong> </a> <button class=navbar-toggler  type=button  data-bs-toggle=collapse  data-bs-target="#navbarCollapse" aria-controls=navbarCollapse  aria-expanded=false  aria-label="Toggle navigation"> <span class=navbar-toggler-icon ></span> </button> <div class="collapse navbar-collapse" id=navbarCollapse > <ul class="navbar-nav me-auto mb-2 mb-md-0"> <li class="nav-item dropdown"> <a class="nav-link dropdown-toggle fw-bold" href="#" id=navbarDropdown  role=button  data-bs-toggle=dropdown  aria-expanded=false > Sites </a> <ul class=dropdown-menu  aria-labelledby=navbarDropdown > <li><h6 class=dropdown-header >Choose a Site</h6> <li><a class=dropdown-item  href="/jan/">Jan's Site</a> <li><a class=dropdown-item  href="/ann/">Ann's Site</a> </ul> <li class=nav-item ><hr class="dropdown-divider mx-2"> <li class=nav-item > <span class="navbar-text px-2 fw-bold d-flex align-items-center">Jan's:</span> <li class=nav-item > <a class=nav-link  aria-current=page  href="/jan/">Home</a> <li class=nav-item > <a class=nav-link  href="/jan/scratchpad/">Posts</a> <li class=nav-item > <a class=nav-link  href="/jan/wip/">Work in Progress</a> <li class=nav-item > <a class=nav-link  href="/jan/about/">About</a> <li class=nav-item > <a class=nav-link  href="/jan/tags/">Tags</a> <li class=nav-item > <a class=nav-link  href="/jan/privacy_policy/">Privacy Policy</a> <li class=nav-item > <a class=nav-link  href="/jan/cookie_policy/">Cookie Policy</a> </ul> </div> </div> </nav> </header> <div class="container py-3 px-3 mx-auto"> <div class=franklin-content ><h2 id=tldr ><a href="#tldr" class=header-anchor >TL;DR</a></h2> <p>Ever had a brilliant idea but got stuck waiting for test data? Learn how to generate high-quality, realistic test data in just 5-10 minutes using LLMs and Julia. We&#39;ll walk through a complete example of generating customer records for fuzzy matching experiments.</p> <div class=franklin-toc ><ol><li><a href="#tldr">TL;DR</a><li><a href="#the_challenge_of_test_data">The Challenge of Test Data</a><li><a href="#llms_to_the_rescue">LLMs to the Rescue</a><li><a href="#implementing_the_generation">Implementing the Generation</a><li><a href="#smart_generation_strategies">Smart Generation Strategies</a><li><a href="#quick_start_guide">Quick Start Guide</a></ol></div> <h2 id=the_challenge_of_test_data ><a href="#the_challenge_of_test_data" class=header-anchor >The Challenge of Test Data</a></h2> <p>Recently, I wanted to experiment with fuzzy matching entities in databases using RAG &#40;Retrieval-Augmented Generation&#41;. While RAG is famous for powering knowledge chatbots, I saw potential for matching similar records across databases. Think finding &quot;John Smith&quot; across systems where he might be listed as &quot;J. Smith&quot; or &quot;Johnny Smith.&quot;</p> <p>Traditional approaches like random data generators often create unrealistic data, while manual creation takes forever. What we need is data that looks and feels real, with natural variations and inconsistencies.</p> <h2 id=llms_to_the_rescue ><a href="#llms_to_the_rescue" class=header-anchor >LLMs to the Rescue</a></h2> <p>This is where LLMs shine. Unlike traditional random generators, LLMs understand context and can generate realistic variations. Using Julia and the PromptingTools package, we can go from idea to usable test data in minutes.</p> <p>The key advantages of LLM-generated data:</p> <ul> <li><p>Natural variations in naming patterns &#40;Bob vs Robert&#41;</p> <li><p>Contextually appropriate email addresses matching names</p> <li><p>Realistic address formats and locations</p> <li><p>Coherent relationships between fields</p> </ul> <h2 id=implementing_the_generation ><a href="#implementing_the_generation" class=header-anchor >Implementing the Generation</a></h2> <p>All you need is to have a clarity on the data you need for your task. Eg, for a fuzzy matching of contacts, you could have:</p> <pre><code class="julia hljs">Base.<span class=hljs-meta >@kwdef</span> <span class=hljs-keyword >struct</span> ContactInfo
    full_name::<span class=hljs-built_in >String</span>
    address::<span class=hljs-built_in >String</span>
    city::<span class=hljs-built_in >String</span>
    state::<span class=hljs-built_in >String</span> = <span class=hljs-string >&quot;NY&quot;</span>
    email::<span class=hljs-built_in >String</span>
    phone::<span class=hljs-built_in >String</span>
<span class=hljs-keyword >end</span></code></pre> <p>And to have some labeled data to test various approaches, you could have:</p> <pre><code class="julia hljs"><span class=hljs-meta >@enum</span> JudgementType DUPLICATE NOTDUPLICATE
<span class=hljs-meta >@enum</span> Difficulty EASY MEDIUM HARD
Base.<span class=hljs-meta >@kwdef</span> <span class=hljs-keyword >struct</span> ContactVariation
    reasoning::<span class=hljs-built_in >String</span>
    type::JudgementType
    difficulty::Difficulty
    full_name::<span class=hljs-built_in >String</span>
    address::<span class=hljs-built_in >String</span>
    city::<span class=hljs-built_in >String</span>
    state::<span class=hljs-built_in >String</span> = <span class=hljs-string >&quot;NY&quot;</span>
    email::<span class=hljs-built_in >String</span>
    phone::<span class=hljs-built_in >String</span>
<span class=hljs-keyword >end</span></code></pre> <p>The best part is that all this can be dictated to your IDE that will efficiently generate the first draft of this flow for you.</p> <img src="/assets/data_gen_for_experiments/diagram.jpeg" width=500  alt="Data Generation Process"> <h2 id=smart_generation_strategies ><a href="#smart_generation_strategies" class=header-anchor >Smart Generation Strategies</a></h2> <p>Here are a few tips to get the most out of LLM data generation:</p> <ol> <li><p><strong>One-Shot Generation</strong>: Always generate all your data in one go. Multiple calls often lead to repetitive data. You&#39;ll hit a natural limit of how many tokens models want to output &#40;asking for 1000 items will get you only a tiny fraction&#41;. If you need more than 50, look for seeding strategies.</p> <li><p><strong>Smart Seeding</strong>: Need more variety? Instead of asking for 1000 random profiles, try this:</p> <ul> <li><p>Generate 10 different careers</p> <li><p>Generate 10 different hobbies</p> <li><p>Generate 10 different locations</p> </ul> <p>Now you have 1000 unique combinations to seed your generations&#33; Create a prompt that uses these seeds as placeholders and generate the corresponding data points.</p> <li><p><strong>Cache and Temperature</strong>: </p> <ul> <li><p>If you need multiple generations, vary the temperature slightly &#40;by 0.001&#41; between calls to avoid hitting the prompt cache. Or use multi-sampling &#40;API kwarg <code>n</code> in OpenAI API&#41;.</p> <li><p>In general, higher temperatures &#40;0.7-0.9&#41; generally work better for diverse data and varying temperature can enhance diversity.</p> </ul> <li><p><strong>Scale Up</strong>: </p> <ul> <li><p>Need even more data? Use <a href="https://huggingface.co/papers/2406.20094">billion personas dataset</a> as seed material</p> <li><p>Break your generation into themed chunks: &quot;generate 50 tech professionals&quot;, &quot;generate 50 healthcare workers&quot;, etc.</p> <li><p>Reuse past generations as seeds for new generations/variations</p> </ul> <li><p><strong>Let Your IDE Help</strong>: </p> <ul> <li><p>Use your IDE&#39;s AI capabilities with PromptingTools cheatsheet &#40;see the repo, folder <code>llm-cheatsheets/</code>&#41;</p> <li><p>Dictate your requirements to generate base data and task-specific variations</p> <li><p>Let the LLM generate the initial code, then make minor edits</p> </ul> </ol> <p>You will have your data in no time&#33;</p> <h2 id=quick_start_guide ><a href="#quick_start_guide" class=header-anchor >Quick Start Guide</a></h2> <p>Want to try this yourself? Here&#39;s the 5-minute path to generating test data using PromptingTools.jl:</p> <p>File <code>types_and_utils.jl</code> Helpful types to steer the generation. We save them into a separate file to be able to lead them in our work later on.</p> <pre><code class="julia hljs"><span class=hljs-comment >## Key types</span>
Base.<span class=hljs-meta >@kwdef</span> <span class=hljs-keyword >struct</span> ContactInfo
    full_name::<span class=hljs-built_in >String</span>
    address::<span class=hljs-built_in >String</span>
    city::<span class=hljs-built_in >String</span>
    state::<span class=hljs-built_in >String</span> = <span class=hljs-string >&quot;NY&quot;</span>
    email::<span class=hljs-built_in >String</span>
    phone::<span class=hljs-built_in >String</span>
<span class=hljs-keyword >end</span>

<span class=hljs-meta >@enum</span> JudgementType DUPLICATE NOTDUPLICATE
<span class=hljs-meta >@enum</span> Difficulty EASY MEDIUM HARD
Base.<span class=hljs-meta >@kwdef</span> <span class=hljs-keyword >struct</span> ContactVariation
    reasoning::<span class=hljs-built_in >String</span>
    type::JudgementType
    difficulty::Difficulty
    full_name::<span class=hljs-built_in >String</span>
    address::<span class=hljs-built_in >String</span>
    city::<span class=hljs-built_in >String</span>
    state::<span class=hljs-built_in >String</span> = <span class=hljs-string >&quot;NY&quot;</span>
    email::<span class=hljs-built_in >String</span>
    phone::<span class=hljs-built_in >String</span>
<span class=hljs-keyword >end</span>


Base.show(io::<span class=hljs-built_in >IO</span>, contact::<span class=hljs-built_in >Union</span>{ContactInfo,ContactVariation}) = dump(io, contact; maxdepth=<span class=hljs-number >1</span>)


<span class=hljs-comment >## Utility functions</span>
<span class=hljs-string >&quot;Converts a ContactInfo or ContactVariation to a string to pass to a LLM&quot;</span>
<span class=hljs-keyword >function</span> format_contact(contact)
    <span class=hljs-string >&quot;Contact: <span class=hljs-subst >$(contact.full_name)</span>\nAddress: <span class=hljs-subst >$(contact.address)</span>\nCity: <span class=hljs-subst >$(contact.city)</span>\nState: <span class=hljs-subst >$(contact.state)</span>\nEmail: <span class=hljs-subst >$(contact.email)</span>\nPhone: <span class=hljs-subst >$(contact.phone)</span>&quot;</span>
<span class=hljs-keyword >end</span></code></pre> <p>File: <code>generate_contacts.jl</code></p> <p>Now, let&#39;s generate some contacts:</p> <pre><code class="julia hljs">uusing PromptingTools
<span class=hljs-keyword >const</span> PT = PromptingTools
<span class=hljs-keyword >using</span> JSON3
<span class=hljs-keyword >using</span> Dates

include(<span class=hljs-string >&quot;types_and_utils.jl&quot;</span>)

<span class=hljs-comment ># Function to generate diverse contact details</span>
<span class=hljs-keyword >function</span> generate_contacts(n::<span class=hljs-built_in >Int</span>)

    prompt = <span class=hljs-string >&quot;&quot;&quot;Generate <span class=hljs-variable >$n</span> diverse contact details for people in New York state.
    Include variations in names (titles Dr., Mr., Mrs., suffixes like Jr, Sr, III), some short, some long, some with middle names, some with titles.
    Produce diverse addresses, different NY cities, and valid-looking emails and phone numbers.&quot;&quot;&quot;</span>

    response = aiextract(
        prompt;
        return_type=PT.ItemsExtract{ContactInfo},
        model=<span class=hljs-string >&quot;gpt4o&quot;</span>,
        json_mode=<span class=hljs-literal >true</span>,
        strict=<span class=hljs-literal >true</span>
    )

    <span class=hljs-comment ># No need for manual JSON parsing since aiextract handles it</span>
    <span class=hljs-keyword >return</span> response.content.items
<span class=hljs-keyword >end</span>

<span class=hljs-comment ># Function to generate variations</span>
<span class=hljs-keyword >function</span> generate_variations(contact::ContactInfo; n_duplicates::<span class=hljs-built_in >Int</span>=<span class=hljs-number >10</span>, n_similar::<span class=hljs-built_in >Int</span>=<span class=hljs-number >10</span>)
    prompt = <span class=hljs-string >&quot;&quot;&quot;Generate <span class=hljs-subst >$(n_duplicates + n_similar)</span> contact variations.
    Original contact:
    {
        &quot;full_name&quot;: &quot;<span class=hljs-subst >$(contact.full_name)</span>&quot;,
        &quot;address&quot;: &quot;<span class=hljs-subst >$(contact.address)</span>&quot;,
        &quot;city&quot;: &quot;<span class=hljs-subst >$(contact.city)</span>&quot;,
        &quot;state&quot;: &quot;NY&quot;,
        &quot;email&quot;: &quot;<span class=hljs-subst >$(contact.email)</span>&quot;,
        &quot;telephone&quot;: &quot;<span class=hljs-subst >$(contact.telephone)</span>&quot;
    }
    Provide a short reasoning for each variation to explain why it is a duplicate or not duplicate. It must be very clear.

    First <span class=hljs-subst >$(n_duplicates)</span> entries should be duplicates of different levels of difficulty, eg, from simple typos and formatting differences to more complex variations.

    Last <span class=hljs-subst >$(n_similar)</span> entries should be different people with similar attributes to the original contact, but they MUST BE A DIFFERENT person. 
    Provide contacts with different level of difficulty to notice that they are a different person.
    &quot;&quot;&quot;</span>

    response = aiextract(
        prompt;
        return_type=PT.ItemsExtract{ContactVariation},
        model=<span class=hljs-string >&quot;gpt4o&quot;</span>,
        json_mode=<span class=hljs-literal >true</span>,
        strict=<span class=hljs-literal >true</span>
    )

    <span class=hljs-keyword >return</span> response.content.items
<span class=hljs-keyword >end</span>

<span class=hljs-comment ># Generate initial contacts</span>
contacts = generate_contacts(<span class=hljs-number >50</span>)
JSON3.write(<span class=hljs-string >&quot;rag_dedupe/contacts.json&quot;</span>, unique(contacts))

<span class=hljs-comment >## Pick one contact and generate variations for it</span>
contact_idx = <span class=hljs-number >1</span> <span class=hljs-comment ># use more for testing!</span>
selected_contact = contacts[contact_idx]
variations = generate_variations(selected_contact, n_duplicates=<span class=hljs-number >10</span>, n_similar=<span class=hljs-number >10</span>)
JSON3.write(<span class=hljs-string >&quot;rag_dedupe/contact_variations.json&quot;</span>, variations)</code></pre> <div class=page-foot > <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Jan Siml. Last modified: November 27, 2024. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div></div> <footer class=container > <p class=float-end ><a href="#">Back to top</a></p> <div class=footer-icons > <ul class=social-icons > <li><strong>Follow:</strong> <li><a href="https://github.com/svilupp" rel="nofollow noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width=16  height=16  fill=currentColor  class="bi bi-github" viewBox="0 0 16 16"> <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/> </svg> GitHub</a> </ul> </div> <p class=copyright >&copy; 2023- Company, Inc. · <a href="#">Privacy</a> · <a href="#">Terms</a></p> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity=sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm  crossorigin=anonymous ></script> <script src="/libs/highlight/highlight.min.js"></script> <script>hljs.highlightAll();hljs.configure({tabReplace: ' '});</script> <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>